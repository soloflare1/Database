### ‚úÖ 2. `WHERE` ‚Äî Row Filtration in SQL
### students table for example
``` sql
create table students(
    id int,
    name varchar(50),
    marks int not null,
    grade varchar(5),
    city varchar(20),
    primary key(id)
);

INSERT INTO students
(id, name, marks, grade, city)
VALUES
(101, 'anil', 78, 'C', 'Pune'),
(102, 'bhumika', 93, 'A', 'Mumbai'),
(103, 'chetan', 85, 'B', 'Mumbai'),
(104, 'dhruv', 96, 'A', 'Delhi'),
(105, 'emanuel', 12, 'F', 'Delhi'),
(106, 'farah', 82, 'B', 'Delhi');
```
---

## üéØ Purpose:
- Filters data **row by row**
- Always comes **before `GROUP BY`, `ORDER BY`, `HAVING`, or `LIMIT`**
- Cannot use **aggregate functions** like `AVG()`, `SUM()` inside `WHERE` (use `HAVING` instead)

---

## üß© Syntax:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE condition;
````

---

## üîç Examples:

### 1. Get students who scored more than 80:`

```sql
SELECT name, marks
FROM students
WHERE marks > 80;
```

### 2. Get students from 'Delhi':

```sql
SELECT name, city
FROM students
WHERE city = 'Delhi';
```

---

## ‚öôÔ∏è Operators in `WHERE`
**SQL operators** used in the `WHERE` clause.

---

### 1Ô∏è‚É£ Arithmetic Operators

Perfect! Now let's **revisit arithmetic operators used inside the `WHERE` clause** ‚Äî but this time using your actual `students` table. This example-rich guide is tailored for your GitHub SQL notes and includes real query outputs you'd expect from your dataset.

---

````markdown
# ‚ûï Arithmetic Operators in `WHERE` ‚Äî With `students` Table
+, -, *, /, %
---
###Examples:
### ‚ûï 1. Add 5 Bonus Marks ‚Äî Show if New Marks > 90

```sql
SELECT 
    name, 
    marks, 
    marks + 5 AS bonus_marks   -- to see the calculation need to add this
FROM 
    students
WHERE 
    marks + 5 > 90;   -- must include the calculation, not just alias check
```

üßæ **Output:**

| name    | marks |bonus_marks |
| ------- | ----- | ---------- |
| bhumika | 93    | 98         |
| chetan  | 85    | 90         |
| dhruv   | 96    | 101        |

---

### ‚ûñ 2. Subtract Penalty of 10 Marks ‚Äî Check Who Fails (< 40)

```sql
SELECT name, marks, marks - 10 AS penalized
FROM students
WHERE marks - 10 < 40;
```

üßæ **Output:**

| name    | marks | penalized |
| ------- | ----- | --------- |
| emanuel | 12    | 2         |

---



### üîÅ 3. Modulus ‚Äî Find Students With Even Marks

```sql
SELECT name, marks
FROM students
WHERE marks % 2 = 0;
```

üßæ **Output:**

| name  | marks |
| ----- | ----- |
| anil  | 78    |
| dhruv | 96    |
| farah | 82    |


---

## üí° Use With Other Conditions

```sql
SELECT name, marks, city
FROM students
WHERE (marks + 10) > 90 AND city = 'Delhi';
```

üßæ **Output:**

| name  | marks | city  |
| ----- | ----- | ----- |
| dhruv | 96    | Delhi |

---

## üß† Summary Table

| Use Case             | Sample Query (in `WHERE`)      |
| -------------------- | ------------------------------ |
| Bonus marks          | `marks + 5 > 90`               |
| Penalty deduction    | `marks - 10 < 40`              |
| Multiplication check | `marks * 2 > 160`              |
| Division threshold   | `marks / 2 > 40`               |
| Even marks (modulus) | `marks % 2 = 0`                |
| Combine logic        | `marks + 10 > 90 AND city='X'` |

---

## üöÄNotes
## ‚ö†Ô∏è Common Mistake: Using Alias in `WHERE`

### ‚ûï 1. Add 5 Bonus Marks ‚Äî Show Students with New Marks > 90

```sql
SELECT 
    name, 
    marks, 
    marks + 5 AS bonus_marks
FROM 
    students
WHERE 
    marks + 5 > 90;   -- ‚úÖ Correct: do the calculation here directly
````

### ‚ùå Incorrect Version: Referencing Alias in `WHERE

```sql
SELECT 
    name, 
    marks, 
    marks + 5 AS bonus_marks
FROM 
    students
WHERE 
    bonus_marks > 90;  -- ‚ùå ERROR: Alias not recognized here
```

---

### ‚ùì Why does the second one fail?

* SQL processes `WHERE` **before** the `SELECT` clause.
* So, when the `WHERE` clause runs, the alias `bonus_marks` **doesn't exist yet**.
* You must **repeat the expression** inside `WHERE` if you need it.

> ‚úÖ You can use aliases in `ORDER BY`, but **not in `WHERE`**.

---

### üßæ Expected Output

| name    | marks | bonus\_marks |
| ------- | ----- | ------------ |
| bhumika | 93    | 98           |
| chetan  | 85    | 90           |
| dhruv   | 96    | 101          |

---

### ‚úÖ Tip

If you're repeating a long expression and want to avoid duplication, use a **CTE (Common Table Expression)** or a **subquery**.

#### Example using a subquery:

```sql
SELECT *
FROM (
    SELECT 
        name, 
        marks, 
        marks + 5 AS bonus_marks
    FROM students
) AS t
WHERE bonus_marks > 90;
```

‚úÖ Now `bonus_marks` is available in the outer `WHERE`.

--

* Arithmetic operators let you **transform values on the fly** in `WHERE`.
* Combine them with `AND`, `OR`, and other comparisons for powerful filters.
* Don‚Äôt forget: aggregate functions (e.g., `AVG()`) are **not allowed** in `WHERE`.

Use `HAVING` for aggregated conditions after `GROUP BY`.

---


### 2Ô∏è‚É£ Comparison Operators
.
| Operator      | Description              | Example                          |
| -------------: | ------------------------ | -------------------------------- |
| `=`           | Equal to                 | `WHERE city = 'Delhi'`           |
| `!=` / `<>`   | Not equal to             | `WHERE grade != 'F'`             |
| `<`           | Less than                | `WHERE marks < 50`               |
| `>`           | Greater than             | `WHERE marks > 80`               |
| `<=`          | Less than or equal to    | `WHERE marks <= 70`              |
| `>=`          | Greater than or equal to | `WHERE marks >= 90`              |
| `BETWEEN`     | Within range (inclusive) | `WHERE marks BETWEEN 50 AND 80`  |
| `IN`          | Matches any in a list    | `WHERE city IN ('Delhi','Pune')` |
| `LIKE`        | Pattern match            | `WHERE name LIKE 'a%'`           |
| `IS NULL`     | Checks for NULL          | `WHERE cg IS NULL`               |
| `IS NOT NULL` | Checks NOT NULL          | `WHERE cg IS NOT NULL`           |

---

## üîç Each Query ‚Äî Explained Clearly

### 1Ô∏è‚É£ `=` ‚Äî return students whose `city` is exactly `'Delhi'`

```sql
SELECT name, city 
FROM students 
WHERE city = 'Delhi';
```
---
### 2Ô∏è‚É£ `!=` or `<>` ‚Äî All students **except** those whose grade is `'F'`.

```sql
SELECT name, grade 
FROM students 
WHERE grade != 'F';
```
---

### 5Ô∏è‚É£ `>=` ‚Äî Students who scored **85 or above**.

```sql
SELECT name, marks 
FROM students 
WHERE marks >= 85;
```

### 7Ô∏è‚É£ `BETWEEN` ‚Äî Range (Inclusive)
-- Students who scored **between 80 and 90** (including both).

```sql
SELECT name, marks 
FROM students 
WHERE marks BETWEEN 80 AND 90;
```
---

### 8Ô∏è‚É£ `IN` ‚Äî Match from List
-- returns Students who live in either **Delhi** or **Pune**.
```sql
SELECT name, city 
FROM students 
WHERE city IN ('Delhi', 'Pune');
```
-- returns Students who get any of the giveen marks.
```sql
SELECT name, marks
FROM students
WHERE marks in (23,6,54,87,90,95,82)
```
---

### 9Ô∏è‚É£ `LIKE` ‚Äî Pattern Matching (String Filtering)

`LIKE` is used to **filter string data** based on patterns using wildcards:

- `%` ‚Üí Matches **any number** of characters (including zero)
- `_` ‚Üí Matches **exactly one** character

---

### üß™ Example 1: Names that start with `'a'`

```sql
SELECT name 
FROM students 
WHERE name LIKE 'a%';
````

**üßæ What it returns:** Names starting with **'a'**

**‚úÖ Output:**

* anil

---

### üß™ Example 2: Names that end with `'a'

```sql
SELECT name 
FROM students 
WHERE name LIKE '%a';
```

**üßæ What it returns:** Names ending with **'a'**

**‚úÖ Output:**

* bhumika
* farah *(does not match, ends with 'h')*

---

### üß™ Example 3: Names that start and end with `'a'`

```sql
SELECT name 
FROM students 
WHERE name LIKE 'a%a';
```

**üßæ What it returns:** Names starting and ending with **'a'**

**‚úÖ Output:**

* No result in current data
  (like `'alina'`, `'anita'`, etc.)

---

### üß™ Example 4:  ‚Äî `_a%a_`

```sql
SELECT name 
FROM students 
WHERE name LIKE '_a%a_';
```

**üßæ What it returns:**

* Matches:

  * Second letter is `'a'`
  * Ends with `'a'`
  * Total length at least **4 characters**

**‚úÖ Output:**

* **farah** ‚úÖ


* striver -> 
where name like __%v_r  

üß† **Pattern Breakdown**:

* `_` ‚Üí first character: any
* `a` ‚Üí second character must be `'a'`
* `%` ‚Üí zero or more characters
* `a` ‚Üí one `'a'` later in the string
* `_` ‚Üí must end with any single character

---

### üß† Summary of Pattern Matching:

| Pattern   | Matches Example      | Meaning                                 |
| --------- | -------------------- | --------------------------------------- |
| `'a%'`    | `'anil'`             | Starts with `'a'`                       |
| `'%a'`    | `'bhumika'`          | Ends with `'a'`                         |
| `'%a%'`   | `'anil', 'bhumika'`  | Contains `'a'` anywhere                 |
| `'a%a'`   | `'alina'`, `'anita'` | Starts and ends with `'a'`              |
| `'_a%'`   | `'farah'`            | Second character is `'a'`               |
| `'_a%a_'` | `'farah'`            | Second is `'a'`, ends in `'a'`, ‚â• 5 len |

---

### üß™ Bonus ‚Äî Case Sensitivity

* In **MySQL**, `LIKE` is **case-insensitive** by default.
* In **PostgreSQL**, `LIKE` is **case-sensitive**. Use `ILIKE` for case-insensitive match.

---

### üîü `IS NULL` ‚Äî Null Check

```sql
SELECT name, id 
FROM students 
WHERE id IS NULL;
```

**üßæ What it returns:**
Only students whose `id` is NULL.
---

### üß† Summary 

| Query                           | What It Does                          |
| ------------------------------- | ------------------------------------- |
| `WHERE city = 'Delhi'`          | Match exact value                     |
| `WHERE grade != 'F'`            | Exclude specific value                |
| `WHERE marks > 90`              | Get values **greater than** 90        |
| `WHERE marks < 40`              | Get values **less than** 40           |
| `WHERE marks >= 85`             | Get **85 or higher**                  |
| `WHERE marks <= 82`             | Get **82 or below**                   |
| `WHERE marks BETWEEN 80 AND 90` | Range filter (inclusive of 80 and 90) |
| `WHERE city IN (...)`           | Match from a **list** of values       |
| `WHERE name LIKE 'a%'`          | Pattern match (starts with 'a')       |
| `WHERE cg IS NULL`              | Check for missing/null data           |

---

### NOTE:
* `IS NULL`/`IS NOT NULL` 
    for NULL checks.
    **NULL** means **missing/unknown value**.
* `=` and `!=` 
    works only with **non-NULL values**.
    for regular equality/inequality comparisons only.

* Never use = NULL or != NULL ‚Äî it doesn‚Äôt work
---

### Examples:

```sql
-- Correct: Check NULL
WHERE marks IS NULL;

-- Correct: Check NOT NULL
WHERE city IS NOT NULL;

-- Correct: Not equal
WHERE grade != 'A';

-- Incorrect: Comparing NULL
WHERE marks != NULL;  -- Wrong!
```
---
- **NOT**  
  - Logical negation operator.  
  - Reverses a condition.  
  - Example: `WHERE NOT city = 'Delhi'` means city is anything **but** Delhi.

- **!=**  
  - Means **not equal to**.  
  - Used to filter rows where values don‚Äôt match.  
  - Example: `WHERE grade != 'A'` filters students not having grade A.

- **IS NOT NULL**  
  - Checks for values that are **not NULL** (i.e., values are present).  
  - Example: `WHERE marks IS NOT NULL` returns rows where marks are known.

---

### 3Ô∏è‚É£ Logical Operators

| Operator | Description                    | Example                                 |
| -------- | ------------------------------ | --------------------------------------- |
| `AND`    | All conditions must be true    | `WHERE city = 'Delhi' AND marks > 80`   |
| `OR`     | At least one condition is true | `WHERE city = 'Delhi' OR city = 'Pune'` |
| `NOT`    | Negates the condition          | `WHERE NOT grade = 'F'`                 |

---


888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888
### 4Ô∏è‚É£ Special Operators

| Operator       | Description                         | Example                                                            |
| -------------- | ----------------------------------- | ------------------------------------------------------------------ |
| `EXISTS`       | Checks if subquery returns any rows | `WHERE EXISTS (SELECT * FROM students WHERE city = 'Delhi')`       |
| `ANY` / `SOME` | Compares to any value in subquery   | `WHERE marks > ANY (SELECT marks FROM students WHERE city='Pune')` |
| `ALL`          | Compares to all values in subquery  | `WHERE marks > ALL (SELECT marks FROM students WHERE city='Pune')` |
| `CASE`         | Adds conditional logic              | See below ‚Üì                                                        |

---

## üß† `CASE` Inside SELECT for Conditional Output

```sql
SELECT name, marks,
  CASE
    WHEN marks >= 90 THEN 'Excellent'
    WHEN marks >= 75 THEN 'Good'
    ELSE 'Needs Improvement'
  END AS performance
FROM students;
```

---

## üí° `WHERE` vs `HAVING` ‚Äì Key Difference

### üßæ Problem Example:

**‚ùå Invalid** (uses `AVG()` in WHERE):

```sql
SELECT city, AVG(marks)
FROM students
WHERE AVG(marks) > 80  -- ‚ùå Not allowed here
GROUP BY city;
```

**‚úÖ Correct** (use `HAVING` for aggregate functions):

```sql
SELECT city, AVG(marks) AS avg_marks
FROM students
GROUP BY city
HAVING AVG(marks) > 80;
```

---

## üßæ Summary Table: `WHERE` vs `HAVING`

| Feature         | `WHERE`                      | `HAVING`                        |
| --------------- | ---------------------------- | ------------------------------- |
| Filters         | Individual rows              | Grouped data (after `GROUP BY`) |
| Aggregates?     | ‚ùå Not allowed               | ‚úÖ Allowed                       |
| Evaluation Time | Before grouping              | After grouping                  |
| Used With       | `SELECT`, `UPDATE`, `DELETE` | Only with `GROUP BY`            |

---

## üìùNotes:

* Use `WHERE` to **filter raw rows**.
* Use `HAVING` to **filter grouped results**.
* Always place `WHERE` **before `GROUP BY`**, `ORDER BY`, or `LIMIT`.
* Use parentheses `()` to manage complex `AND`/`OR` logic clearly.

---

## ‚úÖ Practice 

**Q: Find all cities where the average marks of students (with marks > 50) is more than 75.**

```sql
SELECT city, AVG(marks) AS avg_marks
FROM students
WHERE marks > 50
GROUP BY city
HAVING AVG(marks) > 75
ORDER BY avg_marks DESC;
```


---

